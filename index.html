<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>追梦之路 ✨</title>
<style>
:root{
  --bg:#04030a; --card-radius:18px;
  --neon1:#7ef9ff; --neon2:#a57bff;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#07051a);font-family:Inter,Arial,Helvetica,sans-serif;color:#fff;overflow:hidden}
#overlay-filetip{position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:9999;display:none;align-items:center;justify-content:center;padding:20px}
#overlay-filetip .box{background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));padding:20px;border-radius:12px;max-width:720px;text-align:center}
.container{height:100vh;display:flex;align-items:center;justify-content:center;position:relative;z-index:2}
canvas{position:fixed;left:0;top:0;width:100%;height:100%;display:block}

/* card */
.card{position:relative;z-index:20;width:380px;padding:26px;border-radius:var(--card-radius);background:linear-gradient(135deg, rgba(70,110,170,0.16), rgba(10,20,40,0.22));border:1px solid rgba(255,255,255,0.04);backdrop-filter: blur(8px);box-shadow:0 10px 40px rgba(0,0,0,0.6)}
@media(max-width:480px){ .card{width:92%;padding:16px} }
.logo{font-weight:800;font-size:20px;color:var(--neon1);text-align:center;margin-bottom:6px}
.subtitle{font-size:13px;color:rgba(255,255,255,0.75);text-align:center;margin-bottom:12px}
.input{width:100%;padding:12px;border-radius:10px;border:none;margin:8px 0;background:rgba(255,255,255,0.06);color:#fff;font-size:15px}
.btn{width:100%;padding:12px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--neon2),var(--neon1));color:#06121a;font-weight:700;cursor:pointer;margin-top:8px;position:relative;overflow:hidden}
.row{display:flex;gap:10px;margin-top:10px;align-items:center}
.social{flex:1;padding:10px;border-radius:8px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);text-align:center;cursor:pointer;border:1px solid rgba(255,255,255,0.03)}

.top-controls{position:fixed;left:12px;top:12px;z-index:40;display:flex;gap:8px}
.icon{padding:8px 10px;border-radius:10px;background:rgba(0,0,0,0.28);border:1px solid rgba(255,255,255,0.04);cursor:pointer;font-size:14px}
.msg{margin-top:8px;color:#ffb3c9;font-size:13px;text-align:center}

/* tip sticky style */
.tips{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:30}
.tip{position:absolute;padding:8px 12px;border-radius:8px;background:#fff;border-left:6px solid #ff9fbf;color:#111;font-weight:700;opacity:0;box-shadow:0 6px 18px rgba(0,0,0,0.35);white-space:nowrap}

/* ripple & particle containers */
.ripple{position:absolute;border-radius:50%;background:rgba(255,255,255,0.12);pointer-events:none;transform:scale(0);opacity:1}
.particle{position:absolute;width:8px;height:8px;border-radius:50%;pointer-events:none;opacity:1;transform:translate3d(0,0,0)}

</style>
</head>
<body>

<!-- Overlay when file:// detected -->
<div id="overlay-filetip"><div class="box">
  <h2>本地直接打开检测到 file:// 协议</h2>
  <p>为确保登录与 Firebase 功能正常运行，请通过以下任一方式打开页面：</p>
  <ul style="text-align:left;max-width:560px;margin:0 auto">
    <li>在 VS Code 中安装并使用 <b>Live Server</b> 扩展（右键 → Open with Live Server）</li>
    <li>或将文件上传到 <b>GitHub Pages</b> / Netlify / Vercel（免费）并通过 https:// 访问</li>
  </ul>
  <p style="margin-top:12px"><button id="filetipClose" style="padding:8px 12px;border-radius:8px;background:#7ef9ff;border:none;color:#06121a;cursor:pointer">我知道了（仍尝试）</button></p>
</div></div>

<!-- canvases -->
<canvas id="meteorCanvas"></canvas>
<canvas id="bgCanvas"></canvas>

<!-- top controls -->
<div class="top-controls">
  <div class="icon" id="playToggle">播放/停止 音乐</div>
  <div class="icon" id="shareBtn">生成分享链接</div>
  <div class="icon" id="adminBtn">管理员面板</div>
</div>

<!-- center login card -->
<div class="container">
  <div class="card" id="authCard" role="region" aria-label="登录卡片">
    <div class="logo">追梦之路 ✨</div>
    <div class="subtitle">欢迎 — 登录或注册（点击任意按钮可开始音乐）</div>

    <input id="email" class="input" type="email" placeholder="邮箱（用于登录）" autocomplete="username" />
    <input id="pwd" class="input" type="password" placeholder="密码" autocomplete="current-password" />

    <button class="btn" id="loginBtn">登录</button>
    <button class="btn" id="regBtn" style="margin-top:10px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff">注册</button>

    <div class="row" style="margin-top:12px">
      <div class="social" id="wechatBtn">微信</div>
      <div class="social" id="qqBtn">QQ</div>
      <div class="social" id="weiboBtn">微博</div>
    </div>

    <div class="msg" id="msg"> </div>
  </div>
</div>

<!-- tips root -->
<div class="tips" id="tipsRoot"></div>

<!-- audio -->
<audio id="bgm" playsinline crossorigin="anonymous" src="https://cdn.jsdelivr.net/gh/zhou-sir6668899/web-1/zhuimeng.mp3" loop></audio>

<!-- main script: module so we can dynamic import -->
<script type="module">
(async ()=>{

  // ---------- file:// detection ----------
  const overlay = document.getElementById('overlay-filetip');
  const isFile = location.protocol === 'file:';
  if(isFile){
    overlay.style.display = 'flex';
  }
  document.getElementById('filetipClose').addEventListener('click', ()=>{ overlay.style.display='none'; });

  // small helper: create ripple + particles when clicking buttons
  function createClickEffect(x,y,opts={color:null,particleCount:18}){
    // ripple
    const r = document.createElement('div'); r.className='ripple';
    document.body.appendChild(r);
    const size = Math.max(window.innerWidth, window.innerHeight)*0.18;
    r.style.width = r.style.height = size + 'px';
    r.style.left = (x - size/2) + 'px';
    r.style.top = (y - size/2) + 'px';
    r.style.transition = 'transform .6s ease, opacity .6s ease';
    r.style.transform = 'scale(0)';
    r.style.opacity = '0.25';
    requestAnimationFrame(()=>{ r.style.transform = 'scale(1)'; r.style.opacity = '0'; });
    setTimeout(()=> r.remove(), 650);

    // particles
    for(let i=0;i<opts.particleCount;i++){
      const p = document.createElement('div'); p.className='particle';
      const s = 6 + Math.random()*8;
      p.style.width = p.style.height = s+'px';
      p.style.left = (x - s/2) + 'px';
      p.style.top = (y - s/2) + 'px';
      p.style.background = opts.color || `hsl(${Math.random()*360},80%,65%)`;
      p.style.transition = 'transform .8s cubic-bezier(.2,.8,.2,1), opacity .8s';
      document.body.appendChild(p);
      const dx = (Math.random()-0.5)*300;
      const dy = (Math.random()-0.5)*300;
      requestAnimationFrame(()=>{ p.style.transform = `translate(${dx}px,${dy}px) scale(0.3)`; p.style.opacity = '0'; });
      setTimeout(()=> p.remove(), 850);
    }
  }

  // attach global quick click-to-effect for buttons to improve perceived responsiveness
  function attachClickEffectTo(el){
    el.addEventListener('click', (ev)=>{
      const x = ev.clientX || (window.innerWidth/2);
      const y = ev.clientY || (window.innerHeight/2);
      createClickEffect(x,y,{particleCount:22});
    });
  }

  // elements
  const emailEl = document.getElementById('email');
  const pwdEl = document.getElementById('pwd');
  const loginBtn = document.getElementById('loginBtn');
  const regBtn = document.getElementById('regBtn');
  const msgEl = document.getElementById('msg');
  const wechatBtn = document.getElementById('wechatBtn');
  const qqBtn = document.getElementById('qqBtn');
  const weiboBtn = document.getElementById('weiboBtn');
  const playToggle = document.getElementById('playToggle');
  const bgm = document.getElementById('bgm');
  const tipsRoot = document.getElementById('tipsRoot');
  const adminBtn = document.getElementById('adminBtn');
  const shareBtn = document.getElementById('shareBtn');

  [loginBtn, regBtn, wechatBtn, qqBtn, weiboBtn, playToggle, adminBtn, shareBtn].forEach(attachClickEffectTo);

  // ensure music plays on first user gesture
  ['click','touchstart'].forEach(ev => document.addEventListener(ev, ()=>{ bgm.play().catch(()=>{}); }, {once:true, passive:true}));

  // If running from file:// we skip Firebase initialization but allow visuals & click effects
  if(isFile){
    msgEl.textContent = '警告：当前以 file:// 打开，Firebase 功能可能不可用。建议使用 Live Server 或部署到 GitHub Pages。';
    // still init visuals so you can see front-end effects
    initVisuals();
    return;
  }

  // ---------- dynamic import Firebase only when not file:// ----------
  const [{ initializeApp }, { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged }, { getFirestore, collection, addDoc, query, orderBy, limit, getDocs, serverTimestamp }] = await Promise.all([
    import('https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js'),
    import('https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js'),
    import('https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js')
  ]);

  // ---------- Firebase config (your project) ----------
  const firebaseConfig = {
    apiKey: "AIzaSyADOCcNc25GUmDNKiHGZxLnFcUjaq1tlOo",
    authDomain: "hawk-e6b7b.firebaseapp.com",
    projectId: "hawk-e6b7b",
    storageBucket: "hawk-e6b7b.firebasestorage.app",
    messagingSenderId: "569058504244",
    appId: "1:569058504244:web:485093c03906bd05c6a461"
  };
  const ADMIN_EMAIL = 'hawkzhou@123.com';

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // Non-blocking recordLogin: start IP/loc fetches in background and addDoc when ready
  async function recordLogin(email, action='login', shareId=null, provider=null){
    // start ip fetch and geolocation in parallel, but do not block UI
    let ip = null; let loc = null;
    (async ()=>{
      try{ const r = await fetch('https://api.ipify.org?format=json'); const j = await r.json(); ip = j.ip; }catch(e){ ip = null; }
    })();
    (async ()=>{
      try{
        if(navigator.geolocation){
          navigator.geolocation.getCurrentPosition(p=>{ loc = p.coords.latitude.toFixed(4)+','+p.coords.longitude.toFixed(4); }, ()=>{}, {timeout:3000});
        }
      }catch(e){ loc = null; }
    })();

    // wait a short time for ip/loc to resolve but don't block too long
    await new Promise(res=>setTimeout(res, 600));
    try{
      await addDoc(collection(db,'loginRecords'), { email: email||null, action, time: serverTimestamp(), ip, loc, userAgent: navigator.userAgent, shareId, provider });
    }catch(e){ console.warn('write log failed', e); }
  }

  // ---------- Auth actions (UI-first, network-second) ----------
  regBtn.addEventListener('click', async (ev)=>{
    // immediate UI feedback + click effects already handled
    msgEl.textContent = '注册中...';
    try{
      const email = emailEl.value.trim(); const pwd = pwdEl.value;
      if(!email || !pwd){ msgEl.textContent='请输入邮箱和密码'; return; }
      // optimistic UI: show success quickly if network is slow
      createUserWithEmailAndPassword(auth, email, pwd)
        .then(async (u)=>{
          msgEl.textContent = '注册成功，已登录';
          recordLogin(email, 'register');
        })
        .catch(err=>{
          console.error(err);
          if(err.code === 'auth/email-already-in-use') msgEl.textContent = '该邮箱已被注册';
          else msgEl.textContent = '注册失败: ' + (err.message || err.code);
        });
    }catch(e){ msgEl.textContent = '注册失败: ' + (e.message || e); }
  });

  loginBtn.addEventListener('click', async (ev)=>{
    msgEl.textContent = '登录中...';
    try{
      const email = emailEl.value.trim(); const pwd = pwdEl.value;
      if(!email || !pwd){ msgEl.textContent='请输入邮箱和密码'; return; }
      signInWithEmailAndPassword(auth, email, pwd)
        .then(async (u)=>{
          msgEl.textContent = '';
          recordLogin(email, 'login');
          // hide card and start visuals (auth state listener will also do it)
        })
        .catch(err=>{
          console.error(err);
          if(err.code === 'auth/user-not-found') msgEl.textContent='账号不存在，请先注册';
          else if(err.code === 'auth/wrong-password') msgEl.textContent='密码错误';
          else msgEl.textContent = '登录失败: ' + (err.message || err.code);
        });
    }catch(e){ msgEl.textContent = '登录错误: ' + (e.message || e); }
  });

  // social placeholder with immediate feedback
  function socialSim(name){
    msgEl.textContent = name + ' 登录（模拟）...';
    setTimeout(()=>{ msgEl.textContent = ''; alert(name + ' 登录（模拟）功能正在开发中。'); }, 400);
  }
  wechatBtn.addEventListener('click', ()=>socialSim('微信'));
  qqBtn.addEventListener('click', ()=>socialSim('QQ'));
  weiboBtn.addEventListener('click', ()=>socialSim('微博'));

  // share
  shareBtn.addEventListener('click', async ()=>{
    const shareId = Math.random().toString(36).slice(2,9);
    const u = auth.currentUser;
    recordLogin(u ? u.email : 'anonymous', 'share', shareId);
    const url = location.origin + location.pathname + '?share=' + shareId;
    prompt('复制并发给好友：', url);
  });

  // admin panel (reads logs)
  adminBtn.addEventListener('click', async ()=>{
    const u = auth.currentUser;
    if(!u){ alert('请先以管理员账号登录'); return; }
    if(u.email !== ADMIN_EMAIL){ alert('当前账户非管理员'); return; }
    try{
      const q = query(collection(db,'loginRecords'), orderBy('time','desc'), limit(500));
      const snap = await getDocs(q);
      const panel = document.createElement('div'); panel.className='admin-panel';
      let html = '<div style="display:flex;justify-content:space-between;align-items:center"><h3>管理员日志（最近）</h3><div><button id="closeAdmin" class="btn">关闭</button></div></div><div class="table">';
      snap.forEach(doc=>{ const d = doc.data(); const t = d.time && d.time.toDate ? d.time.toDate().toLocaleString() : '-'; html += `<div class="row-item">[${t}] <b>${d.email||'-'}</b> — ${d.action} ${d.shareId?(' — share:'+d.shareId):''} <br/><small>ip:${d.ip||'-'} loc:${d.loc||'-'} ua:${(d.userAgent||'').slice(0,80)}</small></div>`; });
      html += '</div>'; panel.innerHTML = html; document.body.appendChild(panel);
      document.getElementById('closeAdmin').onclick = ()=> panel.remove();
    }catch(e){ alert('读取日志失败：' + (e.message||e)); }
  });

  // auth sentinel: when logged in hide auth card and start visuals
  onAuthStateChanged(auth, (user)=>{
    if(user){
      document.getElementById('authCard').style.display = 'none';
      initVisuals(); // start particle heart & tips
    } else {
      document.getElementById('authCard').style.display = 'block';
      tipsRoot.innerHTML = '';
    }
  });

  // play / pause
  playToggle.addEventListener('click', ()=>{ if(bgm.paused){ bgm.play().catch(()=>{}); playToggle.textContent='停止音乐'; } else { bgm.pause(); playToggle.textContent='播放/停止 音乐'; } });

  // ---------- VISUALS (single set of definitions) ----------
  function initVisuals(){
    // meteors
    const meteorCanvas = document.getElementById('meteorCanvas');
    const mctx = meteorCanvas.getContext('2d');
    function resizeM(){ meteorCanvas.width = innerWidth; meteorCanvas.height = innerHeight; }
    addEventListener('resize', ()=>{ resizeM(); resizeMain(); });
    resizeM();

    const meteors = [];
    function spawnMeteor(){
      if(meteors.length < 18 && Math.random() < 0.6){
        meteors.push({
          x: Math.random()*meteorCanvas.width,
          y: Math.random()*meteorCanvas.height*0.45,
          len: 80 + Math.random()*160,
          vx: -6 - Math.random()*6,
          vy: 2 + Math.random()*2,
          hue: 180 + Math.random()*200,
          life: 40 + Math.random()*80
        });
      }
      setTimeout(spawnMeteor, 300 + Math.random()*900);
    }
    spawnMeteor();
    function drawMeteors(){
      mctx.clearRect(0,0,meteorCanvas.width,meteorCanvas.height);
      for(let i=meteors.length-1;i>=0;i--){
        const s = meteors[i];
        mctx.beginPath();
        const grd = mctx.createLinearGradient(s.x, s.y, s.x + s.vx*s.len, s.y + s.vy*s.len);
        grd.addColorStop(0, `hsla(${s.hue},90%,70%,0.9)`);
        grd.addColorStop(1, `hsla(${s.hue},90%,60%,0)`);
        mctx.strokeStyle = grd; mctx.lineWidth = 2;
        mctx.moveTo(s.x, s.y); mctx.lineTo(s.x + s.vx*s.len, s.y + s.vy*s.len); mctx.stroke();
        s.x += s.vx; s.y += s.vy; s.life--;
        if(s.life <= 0 || s.x < -200 || s.y > meteorCanvas.height + 200) meteors.splice(i,1);
      }
      requestAnimationFrame(drawMeteors);
    }
    drawMeteors();

    // main canvas heart
    const canvas = document.getElementById('bgCanvas');
    const ctx = canvas.getContext('2d');
    function resizeMain(){ canvas.width = innerWidth; canvas.height = innerHeight; makeHeartParticles(); }
    resizeMain();

    // heart particles (single definition)
    let heartParts = [];
    function heartFn(t){ const x = 16*Math.pow(Math.sin(t),3); const y = 13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t); return [x,y]; }
    function makeHeartParticles(){
      heartParts = [];
      const n = Math.max(220, Math.floor((canvas.width*canvas.height)/8000)); // scale by area
      for(let i=0;i<n;i++){
        const t = (i/n)*Math.PI*2;
        const [hx,hy] = heartFn(t);
        heartParts.push({ x: canvas.width/2 + hx*10 + (Math.random()-0.5)*10, y: canvas.height/2 - hy*10 + (Math.random()-0.5)*10, vx:0, vy:0, size:1+Math.random()*2.2, hue: Math.floor(Math.random()*360) });
      }
    }
    makeHeartParticles();

    const bursts = [];
    function spawnBursts(x,y,count=28){
      for(let i=0;i<count;i++) bursts.push({ x, y, vx:(Math.random()-0.5)*8, vy:(Math.random()-0.9)*8, life:60+Math.random()*80, hue: Math.floor(Math.random()*360), size:1+Math.random()*3 });
    }

    // add click burst on whole canvas for touch devices
    canvas.addEventListener('click',(e)=>{
      const r = canvas.getBoundingClientRect();
      spawnBursts(e.clientX - r.left, e.clientY - r.top, 28);
    });

    let phase = 0;
    function animateMain(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      // background gradient
      const g = ctx.createLinearGradient(0,0,canvas.width,canvas.height); g.addColorStop(0,'rgba(5,4,12,0.45)'); g.addColorStop(1,'rgba(2,2,10,0.45)'); ctx.fillStyle = g; ctx.fillRect(0,0,canvas.width,canvas.height);
      // bursts
      for(let i=bursts.length-1;i>=0;i--){
        const b = bursts[i]; b.x += b.vx; b.y += b.vy; b.life--; ctx.beginPath(); ctx.fillStyle = `hsl(${b.hue},80%,60%,${Math.max(0,b.life/120)})`; ctx.arc(b.x,b.y,b.size,0,Math.PI*2); ctx.fill(); if(b.life<=0) bursts.splice(i,1);
      }
      phase += 0.02;
      const scale = 1 + 0.06*Math.sin(phase*2);
      for(let i=0;i<heartParts.length;i++){
        const p = heartParts[i];
        const t = (i/heartParts.length)*Math.PI*2 + phase*0.04;
        const [hx,hy] = heartFn(t);
        const tx = canvas.width/2 + hx*10*scale; const ty = canvas.height/2 - hy*10*scale;
        p.vx += (tx - p.x)*0.02; p.vy += (ty - p.y)*0.02; p.vx *= 0.92; p.vy *= 0.92;
        p.x += p.vx; p.y += p.vy;
        ctx.beginPath(); ctx.fillStyle = `hsl(${p.hue},85%,60%)`; ctx.arc(p.x,p.y,p.size,0,Math.PI*2); ctx.fill();
      }
      requestAnimationFrame(animateMain);
    }
    animateMain();

    // ---------- TIPs (sticky notes) ----------
    let tipsLaunched = false;
    function launchTips(){
      if(tipsLaunched) return; tipsLaunched = true;
      tipsRoot.innerHTML = '';
      const texts = ['坚持就是胜利','相信自己，你可以','每一步都算数','今天比昨天更靠近目标','你值得被善待','失败是学习的一部分','越努力越幸运','勇敢一点，未来属于你'];
      const vw = innerWidth;
      let count = Math.min(80, Math.floor((vw*innerHeight)/90000)); if(count<20) count=20;
      const targets = []; for(let i=0;i<count;i++) targets.push({tx:8 + Math.random()*84, ty:6 + Math.random()*88});
      const sides = ['top','bottom','left','right'];
      for(let i=0;i<count;i++){
        const el = document.createElement('div'); el.className='tip'; el.textContent = texts[Math.floor(Math.random()*texts.length)];
        el.style.background = '#fff'; el.style.color = '#111'; el.style.fontWeight='700'; el.style.borderLeft = '6px solid #ff9fbf'; el.style.padding='8px 12px'; el.style.borderRadius='6px';
        if(innerWidth < 480){ el.style.fontSize='16px'; el.style.padding='10px 14px'; } else if(innerWidth < 900){ el.style.fontSize='14px'; el.style.padding='8px 12px'; } else el.style.fontSize='13px';
        const side = sides[i%4];
        if(side==='top'){ el.style.left = targets[i].tx+'%'; el.style.top='-16%'; el.style.transition='all 5s cubic-bezier(.2,.8,.2,1)'; setTimeout(()=>{ el.style.left = targets[i].tx+'%'; el.style.top = targets[i].ty+'%'; el.style.opacity='1'; }, 50); }
        if(side==='bottom'){ el.style.left = targets[i].tx+'%'; el.style.top='116%'; el.style.transition='all 5s cubic-bezier(.2,.8,.2,1)'; setTimeout(()=>{ el.style.left = targets[i].tx+'%'; el.style.top = targets[i].ty+'%'; el.style.opacity='1'; }, 50); }
        if(side==='left'){ el.style.left='-28%'; el.style.top = targets[i].ty+'%'; el.style.transition='all 5s cubic-bezier(.2,.8,.2,1)'; setTimeout(()=>{ el.style.left = targets[i].tx+'%'; el.style.top = targets[i].ty+'%'; el.style.opacity='1'; }, 50); }
        if(side==='right'){ el.style.left='124%'; el.style.top = targets[i].ty+'%'; el.style.transition='all 5s cubic-bezier(.2,.8,.2,1)'; setTimeout(()=>{ el.style.left = targets[i].tx+'%'; el.style.top = targets[i].ty+'%'; el.style.opacity='1'; }, 50); }
        tipsRoot.appendChild(el);
        el.addEventListener('transitionend', ()=>{ el.animate([{transform:'translateY(0)'},{transform:'translateY(-6px)'},{transform:'translateY(0)'}],{duration:4000,iterations:Infinity,delay:Math.random()*1000}); }, {once:true});
      }
    }

    // ensure launchTips called after visuals start
    window.startMainVisuals = function(){ makeHeartParticles(); /* already called inside */ setTimeout(()=>{ launchTips(); }, 900); };

    // spawn some initial bursts for UX
    for(let i=0;i<12;i++) spawnBursts(Math.random()*canvas.width, Math.random()*canvas.height, 30);

    // check share param visual
    (function checkShare(){ const p=new URLSearchParams(location.search); const s=p.get('share'); if(s) spawnBursts(canvas.width/2,120,50); })();
  } // end !isFile block

})(); // end wrapper
</script>
</body>
</html>
